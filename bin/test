#!/bin/bash

ok=0
bad=0

for fin in "$@"
do
  fbase=${fin%%.in}
  fout="$fbase.out"

  echo "testing $fbase..."

  ./bin/scraper.py < "$fin" > "$fout"

  if diff -q "$fin" "$fout" >/dev/null 2>&1
  then
    echo "$fbase passed"
    ok=$(($ok+1))
  else
    echo "$fbase failed"
    diff -W 200 -y --left-column "$fin" "$fout"
    bad=$(($bad+1))
  fi
done

count=$(($ok+$bad))
echo "test meta summary: $ok passed, $bad failed, and 0 skipped, out of $count test(s)."
if [ $bad -eq 0 ] ; then
  exit 0
else
  exit 1
fi


